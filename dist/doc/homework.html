<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="sa21204151" />


<title>homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">sa21204151</h4>
<h4 class="date">2021/12/16</h4>



<div id="homework-2021-09-16" class="section level2">
<h2>homework 2021-09-16</h2>
<p>Example 1</p>
<p>This is a text example.</p>
<p>Example 2</p>
<p>There is a table.</p>
<table>
<thead>
<tr class="header">
<th>Age</th>
<th>Born</th>
<th>Died</th>
<th>Name</th>
<th>Occupation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>37</td>
<td>1920-07-25</td>
<td>1958-04-16</td>
<td>Rosaline Franklin</td>
<td>Chemist</td>
</tr>
<tr class="even">
<td>61</td>
<td>1876-06-13</td>
<td>1937-10-16</td>
<td>William Gosset</td>
<td>Statistician</td>
</tr>
</tbody>
</table>
<p>Example 3</p>
<p>There is a figure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>y) <span class="co"># 指数分布</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,.<span class="dv">01</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z,<span class="fu">exp</span>(<span class="sc">-</span>z))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="homework-2021-09-23" class="section level2">
<h2>homework 2021-09-23</h2>
<p>###Exercise 3.4</p>
<p>We can calculate the CDF of a Rayleigh(σ) distribution.</p>
<p><span class="math display">\[F(x) = \int_{-\infty}^x f(t)dt =
\begin{cases}
0,&amp;x\lt0,\\
\int_0^x {t\over\sigma^2}e^{-{t\over 2\sigma^2}}dt = 1-e^{-{x^2\over 2\sigma^2}} , &amp;x\ge0.
\end{cases}
\]</span></p>
<p>Then, we can get <span class="math display">\[F^{-1}(u)=\sqrt{-2\sigma^2ln(1-u)} \]</span> when <span class="math inline">\(x\ge0\)</span></p>
<p>So in order to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>),we can generate <span class="math inline">\(U\sim U(0,1)\)</span> first,and return <span class="math inline">\(x=\sqrt{-2\sigma^2ln(u)}\)</span>.</p>
<p>Here are some graphics for different in which we can compare the results between the algorithm above and the theoretical method.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)){</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>{<span class="cf">if</span>(sigma[i]<span class="sc">==</span><span class="fl">0.1</span>){</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq=</span>F,<span class="at">main=</span><span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.1</span>),<span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">5</span>))}</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(sigma[i]<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>{<span class="fu">hist</span>(x,<span class="at">freq=</span>F,<span class="at">main=</span><span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">1</span>),<span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">5</span>))}</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>{<span class="fu">hist</span>(x,<span class="at">freq=</span>F,<span class="at">main=</span><span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">10</span>),<span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">5</span>))}}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma[i]<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The algorithm performs very good.</p>
<p>###Exercise 3.11</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="at">mean=</span><span class="dv">3</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),m,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p2,p1))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> p0<span class="sc">*</span>r1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">*</span>r2</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(r,<span class="at">freq=</span>F,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.75</span>),<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p)){</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>r01 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>r02 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>p00 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),m,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p[i],p[i]))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>r0 <span class="ot">&lt;-</span> p00<span class="sc">*</span>r01 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p00)<span class="sc">*</span>r02</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(p[i]<span class="sc">==</span><span class="fl">0.1</span>){</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(r0,<span class="at">freq=</span>F,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.1</span>),<span class="at">col=</span>i)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span> <span class="cf">if</span>(p[i]<span class="sc">==</span><span class="fl">0.5</span>){</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(r0,<span class="at">freq=</span>F,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.5</span>),<span class="at">col=</span>i)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(r0,<span class="at">freq=</span>F,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.9</span>),<span class="at">col=</span>i)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(p_1\)</span> may decide the weigh of the two distribution. And when <span class="math inline">\(p_1\)</span> is small, the performance of the mixture distribution is similar to the first distribution;when <span class="math inline">\(p_1\)</span> is big , the performance of the mixture distribution is similar to another;when <span class="math inline">\(p_1\)</span> is close to 0.5, there will be a bimodal ditribution.</p>
<p>###Exercise 3.20</p>
<pre><code>## [1] &quot;理论期望    样本均值  理论方差   样本方差&quot;
## [1]  40.00000  40.07591 240.00000 239.66939
## [1]  60.00000  60.21206 200.00000 197.98699
## [1]  90.0000  90.0587 315.0000 313.9060
## [1]  200.0000  199.2267 1250.0000 1282.6836
## [1] 50.00000 50.06428 57.14286 58.35815</code></pre>
<p>The mean and variance is close to the theoretical values.</p>
</div>
<div id="homework-2021-09-30" class="section level2">
<h2>homework 2021-09-30</h2>
<p>###Exercise 5.4</p>
<p>The problem is to estimate <span class="math inline">\(\theta = \int_0^x t^2(1-t)^2dt\)</span>. Making the substitution <span class="math inline">\(u = \frac{t}{x}\)</span> Then, we get <span class="math display">\[\theta = \int_0^1 x(ux)^2(1-ux)^2du = \int_0^1 u^2x^3(1-ux)^2du\]</span> Thus, <span class="math inline">\(\theta = E_u[u^2x^3(1-ux)^2]\)</span>,where the random variable U has the Uniform(0,1)distribution.</p>
<p>So we can generate the compute a Monte Carlo estimate of the Beta(3,3) cdf as follows</p>
<pre><code>##        [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]
## x     0.100 0.200 0.300 0.400 0.500 0.600 0.700 0.800 0.900
## cdf   0.009 0.058 0.163 0.317 0.499 0.687 0.841 0.938 0.988
## pbeta 0.009 0.058 0.163 0.317 0.500 0.683 0.837 0.942 0.991</code></pre>
<p>The algorithm performs very good.</p>
<p>###Exercise 5.9</p>
<p>We can calculate the CDF of a Rayleigh(σ) distribution.</p>
<p><span class="math display">\[F(x) = \int_{-\infty}^x f(t)dt =
\begin{cases}
0,&amp;x\lt0,\\
\int_0^x {t\over\sigma^2}e^{-{t\over 2\sigma^2}}dt = 1-e^{-{x^2\over 2\sigma^2}} , &amp;x\ge0.
\end{cases}
\]</span></p>
<p>Then, we can get <span class="math display">\[F^{-1}(u)=\sqrt{-2\sigma^2ln(1-u)} \]</span> when <span class="math inline">\(x\ge0\)</span></p>
<p>So in order to generate random samples using antithetic variables from a Rayleigh(<span class="math inline">\(\sigma\)</span>),we can generate <span class="math inline">\(U\sim U(0,1)\)</span> first,and return <span class="math inline">\(x=\sqrt{-2\sigma^2ln(u)}\)</span> and <span class="math inline">\(x&#39;=\sqrt{-2\sigma^2ln(1-u)}\)</span></p>
<p>Herea are 200 samples.And the percent reduction in variance of <span class="math inline">\(x+x&#39;\over 2\)</span> compared with <span class="math inline">\(x_1+x_2\over 2\)</span> for independent X1, X2.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>xp <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x,xp),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##     [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
## x  0.099 0.086 0.059 0.203 0.163 0.087 0.126 0.223 0.137 0.221 0.185 0.088
## xp 0.138 0.153 0.192 0.052 0.078 0.152 0.109 0.042 0.100 0.043 0.063 0.150
##    [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## x  0.131 0.083 0.225 0.064 0.063 0.126 0.089 0.147 0.156 0.097 0.012 0.225
## xp 0.105 0.158 0.041 0.183 0.185 0.109 0.150 0.091 0.083 0.140 0.314 0.041
##    [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
## x  0.156 0.277 0.119 0.022 0.130 0.212 0.099 0.088 0.067 0.128 0.156 0.140
## xp 0.084 0.021 0.117 0.273 0.106 0.047 0.138 0.151 0.179 0.108 0.084 0.097
##    [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## x  0.024 0.078 0.142 0.210 0.101 0.217 0.056 0.039 0.161 0.117 0.134 0.085
## xp 0.265 0.164 0.096 0.048 0.135 0.045 0.196 0.228 0.080 0.118 0.102 0.154
##    [,49] [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60]
## x  0.052 0.165 0.079 0.182 0.069 0.147 0.119 0.108 0.102 0.114 0.196 0.127
## xp 0.204 0.077 0.162 0.065 0.176 0.091 0.117 0.128 0.135 0.122 0.056 0.109
##    [,61] [,62] [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72]
## x  0.106 0.094 0.027 0.089 0.052 0.042 0.085 0.095 0.088 0.141 0.054 0.139
## xp 0.130 0.143 0.258 0.150 0.203 0.223 0.154 0.142 0.151 0.096 0.200 0.098
##    [,73] [,74] [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84]
## x  0.075 0.063 0.034 0.120 0.141 0.223 0.103 0.125 0.159 0.083 0.037 0.181
## xp 0.167 0.185 0.241 0.116 0.096 0.042 0.133 0.110 0.082 0.157 0.233 0.066
##    [,85] [,86] [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96]
## x  0.253 0.051 0.087 0.089 0.198 0.187 0.035 0.062 0.160 0.034 0.149 0.279
## xp 0.029 0.206 0.152 0.150 0.055 0.062 0.237 0.187 0.081 0.240 0.090 0.020
##    [,97] [,98] [,99] [,100]
## x  0.155 0.095 0.275  0.115
## xp 0.084 0.142 0.021  0.121</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>MCa <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span>antithetic){</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> u<span class="sc">*</span>x[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u<span class="sc">*</span>x[i]<span class="sc">/</span>(sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>cdf[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g) <span class="sc">/</span> (sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>cdf</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fl">1.95</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>MC1[i] <span class="ot">&lt;-</span> <span class="fu">MCa</span>(x, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>MC2[i] <span class="ot">&lt;-</span> <span class="fu">MCa</span>(x, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">var</span>(MC1) <span class="sc">-</span> <span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.3275398</code></pre>
<p>###Exercise 5.13</p>
<p>Intuitively, We can choose importance function: <span class="math display">\[f_1(x)= {1\over \sqrt {2\pi}}e^{-{x^2 \over 2}},0\le x&lt;+\infty\]</span></p>
<p>And we can make a substitution <span class="math inline">\(u={x^2\over 2}\)</span>,then <span class="math inline">\(\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x=\int_{1\over2}^\infty {u^{1\over2}\over \sqrt {2\pi}}e^{-u}du\)</span> So ,we can choose importance function: <span class="math display">\[f_2(x)=xe^{-{x^2\over 2}},0&lt;x&lt;+\infty\]</span></p>
<p>In fact ,if the pdf of random variables x is <span class="math inline">\(f_2(x)\)</span>,then x is with distribution P(1).</p>
<p>Then we plot the functions for comparison with g(x).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>((<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>((<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="fu">exp</span>((<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,g)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,f1,<span class="at">col =</span> <span class="st">&#39;red&#39;</span>)<span class="co">#f1是红色</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,f2,<span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)<span class="co">#f2是蓝色</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the graphic, we might prefer <span class="math inline">\(f_1\)</span> for the smallest variance.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">runif</span>(<span class="dv">10000</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">10000</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> y<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg1)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg2)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg1)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>se2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg2)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(theta1,theta2)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">c</span>(se1,se2)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">rbind</span>(theta,se))</span></code></pre></div>
<pre><code>##            [,1]      [,2]
## theta 0.3322898 0.3963400
## se    0.2982094 0.3966333</code></pre>
<p>So <span class="math inline">\(f_1\)</span> is better than <span class="math inline">\(f_2\)</span>.</p>
<p>###Example 5.14</p>
<p>Here is the theta(left) and standard deviation(right):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">runif</span>(<span class="dv">10000</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg1)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg1)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(theta1,se1))</span></code></pre></div>
<pre><code>## [1] 0.3290739 0.2973583</code></pre>
</div>
<div id="homework-2021-10-14" class="section level2">
<h2>homework 2021-10-14</h2>
<p>###Exercise 6.5 Suppose a <span class="math inline">\(95 \%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95\)</span>. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to departures from normality than the interval for variance.)</p>
<p><strong>Solution.</strong></p>
<p>The expectation of <span class="math inline">\(\chi^2(2)\)</span> distribution is <span class="math inline">\(2\)</span>, while the variance is <span class="math inline">\(4\)</span>.</p>
<p><strong>t-intervals</strong></p>
<p>We calculate t-intervals based on 1000 replicates.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the half length of CIs</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>CL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  mu.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  sd.hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(n) <span class="sc">*</span> <span class="fu">abs</span>(mu.hat <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> sd.hat</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate coverage proportion</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(CL <span class="sc">&lt;</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 0.926</code></pre>
<p>The proportion that the genuine mean locates in the esitimated CI is <span class="math inline">\(0.926\)</span>, which is a little bit less than the theorical one (<span class="math inline">\(0.95\)</span>).</p>
<p><strong>interval for variance</strong></p>
<p>We calculate intervals for variance based on 1000 replicates.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>cover <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  UpperBound <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  cover[i] <span class="ot">&lt;-</span> (UpperBound <span class="sc">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>(ECP <span class="ot">&lt;-</span> <span class="fu">sum</span>(cover) <span class="sc">/</span> R)</span></code></pre></div>
<pre><code>## [1] 0.797</code></pre>
<p>The proportion that the genuine variance locates in the esitimated CI is <span class="math inline">\(0.797\)</span>, which is far less than the theoretical one (<span class="math inline">\(0.95\)</span>).</p>
<p>As demonstrated by the above results (<span class="math inline">\(0.926&gt;0.797\)</span>), the t-interval is more robust to departures from normality than the interval for variance.</p>
<div id="exercise-6.a" class="section level3">
<h3>Exercise 6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the <span class="math inline">\(t\)</span>-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The <span class="math inline">\(t\)</span>-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform <span class="math inline">\((0,2)\)</span>, and (iii) Exponent<span class="math inline">\(\operatorname{tial}(\mathrm{rate}=1)\)</span>. In each case, test <span class="math inline">\(H_{0}: \mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{0}: \mu \neq \mu_{0}\)</span>, where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform <span class="math inline">\((0,2)\)</span>, and Exponential <span class="math inline">\((1)\)</span>, respectively.</p>
<p><strong>Solution.</strong></p>
<p>The <span class="math inline">\(t\)</span>-test for whether <span class="math inline">\(\mu=\mu_0\)</span> can be characterized as: <span class="math display">\[H_0:\mu=\mu_0\longleftrightarrow H_1:\mu\neq\mu_0\]</span></p>
</div>
</div>
<div id="homework-2021-10-21" class="section level2">
<h2>homework 2021-10-21</h2>
<p>###Example 6.8</p>
<p>以3维随机向量为例</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">3</span>)  <span class="co">#协方差矩阵</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>) <span class="co">#样本量</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># 维度</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">95</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#置信界</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>b1d <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  b1dm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,k<span class="sc">^</span><span class="dv">2</span>),<span class="at">nrow=</span>k,<span class="at">ncol =</span> k)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  x.lc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,d<span class="sc">*</span>k),<span class="at">nrow=</span>k,<span class="at">ncol =</span> d)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    x.lc[,t] <span class="ot">&lt;-</span> x[,t]<span class="sc">-</span><span class="fu">mean</span>(x[,t])</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  sigma.hat <span class="ot">&lt;-</span> <span class="fu">t</span>(x.lc)<span class="sc">%*%</span>x.lc<span class="sc">/</span>k</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  b1dm <span class="ot">&lt;-</span> (x.lc<span class="sc">%*%</span><span class="fu">solve</span>(sigma.hat)<span class="sc">%*%</span><span class="fu">t</span>(x.lc))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(b1dm)<span class="sc">/</span>k<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#储存结果</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#每个样本量重复m次实验</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>mst <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#储存每次实验的检验结果</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[i],<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), sigma)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>mst[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(n[i]<span class="sc">*</span><span class="fu">b1d</span>(x)<span class="sc">/</span><span class="dv">6</span> <span class="sc">&gt;=</span> cv)<span class="co">#拒绝原假设为1，左侧拒绝域</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(mst)<span class="co">#拒绝原假设的频率</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p.reject)</span></code></pre></div>
<pre><code>## [1] 0.001 0.025 0.036 0.040 0.035 0.050 0.053</code></pre>
<p>从结果可以看出，随着样本量的增加，范第一类错误的概率逐渐靠近显著性水平0.05.</p>
<p>###Example 6.10</p>
<p>以3维向量为例</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma &lt;- matrix(c(1,0,0,0,1,0,0,0,1),3,3)  #协方差矩阵</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co">#样本量</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#d &lt;- 3 # 维度</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">9</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#置信界</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(p)) <span class="co">#储存结果</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#每个p重复m次实验</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p)) {</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>mst <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#储存每次实验的检验结果</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span><span class="sc">*</span>n),n,<span class="dv">3</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    sigma1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">size =</span> <span class="dv">1</span>,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p[i], <span class="dv">1</span><span class="sc">-</span>p[i]))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    sigma2 <span class="ot">&lt;-</span> <span class="fu">diag</span>(sigma1,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    x[t,] <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), sigma2)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  mst[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(n<span class="sc">*</span><span class="fu">b1d</span>(x)<span class="sc">/</span><span class="dv">6</span> <span class="sc">&gt;=</span> cv)<span class="co">#拒绝原假设为1，左侧拒绝域</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>pow[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(mst)<span class="co">#拒绝原假设的频率</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, pow, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,<span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pow <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pow) <span class="sc">/</span> m) </span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, pow<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, pow<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>显然，当p也就是<span class="math inline">\(\epsilon\)</span>为1或0时，此分布是多维正态分布，当<span class="math inline">\(\epsilon\)</span>为0到1之间时，不是多维正态分布，符合预期。</p>
</div>
<div id="homework-2021-10-28" class="section level2">
<h2>homework 2021-10-28</h2>
<p>###7.7</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.1.1 来建造的</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12121</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>theta.star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,n,<span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  lambda.star <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor[index,]))<span class="sc">$</span>values</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  theta.star[i] <span class="ot">&lt;-</span> lambda.star[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.star)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">theta.hat=</span> theta.hat,<span class="at">boot.bias_theta=</span><span class="fu">mean</span>(theta.star) <span class="sc">-</span> theta.hat,<span class="at">boot.se_theta=</span><span class="fu">sd</span>(theta.star))</span></code></pre></div>
<pre><code>##       theta.hat boot.bias_theta   boot.se_theta 
##    0.6191150384    0.0007401793    0.0470730748</code></pre>
<p>###7.8</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>theta.j <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor[<span class="sc">-</span>j,]))<span class="sc">$</span>values</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  theta.j[j] <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">jack.bias_theta=</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.j) <span class="sc">-</span> theta.hat),<span class="at">jack.se_theta=</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((<span class="fu">mean</span>(theta.j)<span class="sc">-</span>theta.j)<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## jack.bias_theta   jack.se_theta 
##     0.001069139     0.049552307</code></pre>
<p>###7.9</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12121</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>theta.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data,i){</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  lamdb <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(data[i,]))<span class="sc">$</span>values</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  lamdb[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lamdb)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(scor,<span class="at">statistic =</span> theta.boot,<span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5237,  0.7055 )   ( 0.5210,  0.7046 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="homework-2021-11-04" class="section level2">
<h2>homework 2021-11-04</h2>
<p>###8.2</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>nor <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">10</span>,<span class="dv">10</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nor)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>cor0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nor) {</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sample</span>(N, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> z[n]</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  ys <span class="ot">&lt;-</span> z[<span class="sc">-</span>n] <span class="co">#complement of x1</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  cor[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(xs, ys, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(cor0, cor)) <span class="sc">&gt;</span> <span class="fu">abs</span>(cor0))</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;cor.test&quot;</span> <span class="ot">=</span> p0, <span class="st">&quot;permutation&quot;</span> <span class="ot">=</span> p)</span></code></pre></div>
<pre><code>##    cor.test permutation 
##   0.8380041   0.8060000</code></pre>
<p>我们随机生成了两组随机数，并用cor.test和permutation方法分别计算了双侧相关系数检验的p值（即ASL），得到的结果很接近。</p>
<p>###Question 2</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>NNF <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z);</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;=</span> n1); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>(i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">nrow</span>(x),<span class="fu">nrow</span>(y))</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  energyp.value <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  ballp.value <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(z,<span class="at">statistic =</span> NNF, <span class="at">R =</span> <span class="dv">999</span>, <span class="at">sim =</span>   <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> N, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  ann <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  NNp.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ann<span class="sc">&gt;=</span>ann[<span class="dv">1</span>])</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(NNp.value, energyp.value, ballp.value)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Unequal variances and equal expectations</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">3</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">20</span>,e1,cov1)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">20</span>,e2,cov2)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    p.values[i,] <span class="ot">&lt;-</span> <span class="fu">p</span>(x,y)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  pwr1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="co">#alpha取0.05</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;NN.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">1</span>], <span class="st">&quot;energy.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">2</span>],<span class="st">&quot;ball.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##     NN.power energy.power   ball.power 
##         0.34         0.27         0.77</code></pre>
<p>所以ball方法最好，NN和energy方法相差不大。</p>
<p>Unequal variances and unequal expectations</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">3</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">20</span>,e1,cov1)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">20</span>,e2,cov2)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    p.values[i,] <span class="ot">&lt;-</span> <span class="fu">p</span>(x,y)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  pwr1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="co">#alpha取0.05</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;NN.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">1</span>], <span class="st">&quot;energy.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">2</span>],<span class="st">&quot;ball.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##     NN.power energy.power   ball.power 
##         0.53         0.88         0.86</code></pre>
<p>ball和energy方法相差不大，且比NN好。</p>
<p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution)</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">3</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rt</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rt</span>(<span class="dv">20</span>,<span class="dv">2</span>,<span class="dv">5</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    p.values[i,] <span class="ot">&lt;-</span> <span class="fu">p</span>(x,y)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  pwr1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="co">#alpha取0.05</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;NN.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">1</span>], <span class="st">&quot;energy.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">2</span>],<span class="st">&quot;ball.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##     NN.power energy.power   ball.power 
##         0.69         0.55         0.83</code></pre>
<p>表现： ball&gt;NN&gt;energy</p>
<p>bimodel distribution (mixture of two normal distributions)</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rbimodel <span class="ot">&lt;-</span> <span class="cf">function</span>(n,e1,e2,sd1,sd2){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  index1<span class="ot">&lt;-</span> <span class="fu">which</span>(index<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  x[index1] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(index1), e1, sd1)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  index2 <span class="ot">&lt;-</span> <span class="fu">which</span>(index<span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  x[index2] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(index2), e2, sd2)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">3</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rbimodel</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rbimodel</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    p.values[i,] <span class="ot">&lt;-</span> <span class="fu">p</span>(x,y)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  pwr1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="co">#alpha取0.05</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;NN.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">1</span>], <span class="st">&quot;energy.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">2</span>],<span class="st">&quot;ball.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##     NN.power energy.power   ball.power 
##         0.26         0.50         0.43</code></pre>
<p>表现： energy&gt;ball&gt;NN</p>
<p>Unbalanced samples (say, 1 case versus 10 controls)</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">3</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">10</span>,e1,cov1)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">100</span>,e2,cov2)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    p.values[i,] <span class="ot">&lt;-</span> <span class="fu">p</span>(x,y)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  pwr1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="co">#alpha取0.05</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;NN.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">1</span>], <span class="st">&quot;energy.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">2</span>],<span class="st">&quot;ball.power&quot;</span> <span class="ot">=</span> pwr1[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##     NN.power energy.power   ball.power 
##         0.19         0.88         0.93</code></pre>
<p>根据计算结果可得，ball和energy方法较好，NN方法略差。</p>
</div>
<div id="homework-2021-11-11" class="section level2">
<h2>homework 2021-11-11</h2>
</div>
<div id="section" class="section level1">
<h1>9.3</h1>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a <span class="math inline">\(Cauchy(\theta,\eta)\)</span> distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\quad -\infty&lt;x&lt;\infty,\theta&gt;0\]</span> The standard Cauchy has the <span class="math inline">\(Cauchy(\theta=1,\eta=0)\)</span> density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
<p>解答：</p>
<p>1.由于标准Cauchy分布为对称的，所以不妨取proposal distribution <span class="math inline">\(g(\cdot|X)\)</span>也为对称的正态分布<span class="math inline">\(N(0,X^2)\)</span>密度函数。观察易知标准Cauchy即为自由度为1的t分布。</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span>      <span class="co">#discard the burn-in sample</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  Xt <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">dt</span>(Y,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">dnorm</span>(Xt,<span class="dv">0</span>,<span class="fu">abs</span>(Y))<span class="sc">/</span><span class="fu">dt</span>(Xt,<span class="dv">1</span>)<span class="sc">/</span><span class="fu">dnorm</span>(Y,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r <span class="sc">&gt;</span> <span class="dv">1</span>) r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(U <span class="sc">&lt;=</span> r) X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> X[i] <span class="ot">&lt;-</span> Xt</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N]</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>deciles_sample <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Y, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>)   <span class="co"># 样本的十分位数</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>deciles_true <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>)   <span class="co"># 真实分布的十分位数</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>deciles <span class="ot">&lt;-</span> <span class="fu">rbind</span>(deciles_sample,deciles_true)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(deciles) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;deciles_sample&quot;</span>,<span class="st">&quot;deciles_true&quot;</span>)</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(deciles) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;knitr&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(deciles)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="14%" />
<col width="9%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">0.1</th>
<th align="right">0.2</th>
<th align="right">0.3</th>
<th align="right">0.4</th>
<th align="right">0.5</th>
<th align="right">0.6</th>
<th align="right">0.7</th>
<th align="right">0.8</th>
<th align="right">0.9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">deciles_sample</td>
<td align="right">-3.784873</td>
<td align="right">-1.503723</td>
<td align="right">-0.8212418</td>
<td align="right">-0.4062824</td>
<td align="right">-0.0536587</td>
<td align="right">0.2862329</td>
<td align="right">0.7065849</td>
<td align="right">1.434664</td>
<td align="right">3.359048</td>
</tr>
<tr class="even">
<td align="left">deciles_true</td>
<td align="right">-3.077684</td>
<td align="right">-1.376382</td>
<td align="right">-0.7265425</td>
<td align="right">-0.3249197</td>
<td align="right">0.0000000</td>
<td align="right">0.3249197</td>
<td align="right">0.7265425</td>
<td align="right">1.376382</td>
<td align="right">3.077684</td>
</tr>
</tbody>
</table>
<p>结果发现，样本十分位数与真实分布的十分位数几乎一致。不妨再观察一下QQ图。</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>QR <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(a,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Y, a)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(QR, Q,  <span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Standard Cauchy Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>根据QQ图发现除了最两端的分位数有所差据，整体上来看分位数是一样的，综上说明了由Metropolis-Hastings方法得到样本的有效性。</p>
</div>
<div id="section-1" class="section level1">
<h1>9.8</h1>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x, y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0 \leq y \leq 1.\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).</p>
<p>解答：</p>
<p>由参考文献知<span class="math inline">\((X|Y=y)\overset{d}= B(n,y),\quad (Y|X=x)\overset{d}= Beta(x+a,n-x+b)\)</span>，这里不妨取n为25。</p>
<div id="a1-b1" class="section level2">
<h2>a=1, b=1</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>          <span class="co">#样本量</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  <span class="co">#样本阵</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="a1-b10" class="section level2">
<h2>a=1, b=10</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  <span class="co">#样本</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="补充题" class="section level1">
<h1>补充题</h1>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R&lt;1.2\)</span></p>
<p>解答：</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算Gelman-Rubin statistic的函数</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<div id="section-2" class="section level2">
<h2>9.3</h2>
<p>先按照9.3题写出构造标准柯西分布的Metropolis chain的函数</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成标准柯西分布的Metropolis chain</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 提议函数仍取9.3中使用的对称正态分布 N(0,X[t]^2)</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># X1为初始值</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>Standard_Cauchy_Chain <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X1){</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1    <span class="co">#初始值</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    Xt <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">dt</span>(Y,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">dnorm</span>(Xt,<span class="dv">0</span>,<span class="fu">abs</span>(Y))<span class="sc">/</span><span class="fu">dt</span>(Xt,<span class="dv">1</span>)<span class="sc">/</span><span class="fu">dnorm</span>(Y,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(r <span class="sc">&gt;</span> <span class="dv">1</span>) r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(U <span class="sc">&lt;=</span> r) X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> X[i] <span class="ot">&lt;-</span> Xt</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来不妨考虑生成4条上述Metropolis chain，每条样本量N=8000。</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>      </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">8000</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>     <span class="co">#burn-in length</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)    <span class="co">#初始值</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成4条样本</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  X[i,] <span class="ot">&lt;-</span> <span class="fu">Standard_Cauchy_Chain</span>(N, X1[i])</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.127139</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 四条样本的psi</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col=</span>i)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span></code></pre></div>
<p>实际上发现四条样本的psi图并没有呈现逼近同一分布的结果，这可能是因为Cauchy分布的期望和方差不均存在，进而导致的估计不稳定性，下面再画出<span class="math inline">\(\hat R\)</span>统计量v.s.样本量N的图。</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hat R\)</span> 大概在样本为1000时达到收敛。</p>
</div>
</div>
<div id="section-3" class="section level1">
<h1>9.8</h1>
<p>先按照9.8题写出题中二元随机变量的Gibbs sampler，这里不妨取a=b=1。</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成二元随机变量的Gibbs sampler</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># X1为初始值</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>Bivariate.Gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X1){</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> X1    <span class="co">#初始值</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>不妨还是考虑生成4条样本，每条样本量N=8000.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>          </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">8000</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>    <span class="co">#burn-in length</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="fu">runif</span>(<span class="dv">4</span>)) <span class="co">#初始值</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co">#生成4条样本，每个第一维的放在X中，第二维的放在Y中</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  BG <span class="ot">&lt;-</span> <span class="fu">Bivariate.Gibbs</span>(N, X1[i,])</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> BG[,<span class="dv">1</span>]</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  Y[i, ] <span class="ot">&lt;-</span> BG[,<span class="dv">2</span>]</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>下面分别在每一个维度上考虑利用Gelman-Rubin method考虑样本的收敛情况。</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 先考虑第一维样本X</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 再考虑第二维样本Y</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAARVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6Ojo6kNtmAABmtv+QOgCQ2/+2ZgC2///bkDrbkJDb////tmb/25D//7b//9v///9soTDpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGUElEQVR4nO3da2PSShRG4ahVWymitPD/f6q5FCyXZGUye2dPwrs+KJ6TzuDjMIRbWx3VYFX0FSg9AUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgyBqoWUxSQ7XB+zQyU/g8TnVYQFAu0gIUUvILKv62F38RKFwoHKn03KgDoYuTi7uLigS6sOpuShEoCqkrcmEoAqi5/d5gtowKA7p0TlbOECgLynG56RQBVx5s1U8wSKgGo/cP1+KUIlQFU3fEoRKgIoPsPyQREhxQhVDBQGUuo5GcUi1hCJa+gIoSKBipBqGygAoQKB4oXcgF6f3muf93XW/HX39nzBgv5Ae2+/W0u/codLljIDeiDpmXKGy5WyA3o7XsLtO+5kaUMFyq0gBUUe0rtBNScKz8dT9t15nChS8jrbr42+vJa35H1+CQOFyhU+nmQz+weMwcDhQk5Ae3qPajbpA3uxaYcb5YP0K7ef95fml3aDChKyAXosHluf63v4q2AwpaQ09189wBj++2vHVCQkOMKqts+mQFFLSGnPeiDpT4bugTKeBNn0BJyuxfrbmSHjdkKClpCCzkPar8kRGhBQDFC3kB2m/T065DVklZQyBJaFFCE0LKAAt54vjCg+YkWBzQ3keNTrl2W92LnL56RKAPoT9+LggMn0Onz9nz5bETJQLuPRTFscNg8Gc3bO8BMRKlA+y+vzbMYzevKfc/Hd8dVPS+pps47MMQsRIlA7cp4f/m1a16zmGXewUFmEEoEal/nOmx+VnALspt3eBR/oWSg5pazHb55mc4Lw7gLTQPqeT3ZY14ax1toGtDkG9jNZ/bL/31eoKvhLHJeQ8sHchZKBsIHEcbzjhnLU2iBD1bvDOYotAogT6F1ADkKrQTIT2gtQG6veKwHyEloNUBeQusBchJaEZCP0JqAXIRWBeRyww2a2wnIYe83PzBkuPOwcedXywAKPAG1epZ98nsUx05gPaD5gSHDfRo46oouBSjsii4HyPipJvMDQ4a7GNr22UrzA9sOG3je2vVpZNMnvM0PbNqdXnrt/cih7ysRlq+ZmB94/PRZDaMP9SZnKOQC9OnbCVh8LHxCdkLrXEGGQl570McSitmD2gmMZnC6Fzu9Atv7NhB3ICuhFZ4HnacwmWPFQDZCawYyEVo1kIWQ03mQ7zvtx5cv5LOC3N9pP7rsp+bcHqx6v9N+dJlCXntQzzvt3Z9yvTtn1lebHxgy3PBcOUSPAJRF9BhAGUTeQKYfC89q4sb3KCuom3TKtwwxPzBkuNHTJhM9GFA60cMBpW5GDwh0TDJa+YPV/sae0a/9wSqFSut/sDqiocU084PVqcPNUXVd919Hf7nxtbEdzi8BQQKCBASFAS2mIKDBQZPucFMOtpivLwFBAoIEBAkIEhAkIEhAkICgxTw2iEpAkIAgAUECggQECQgSECQgSECQgCABQQKC7IH21eC3NW8/Wf58ceDtheH+/0DcyUOMzxyo+e74+/7reNjU/2/X/O3OB95egN5+vF7NlTzE+KyBug/+9n9f4e6Hae++/j4feHuBOn3kOmOI8VkDnQEGj6r/kc8H3l6gOXZPV3OlDzE+c6B2+fd9rP7Utv67nA68vUBzbH9221jGEOOzBuo2ANgGmk+Vnw+8vQBTvL80H7re5gyRUATQ/rRH5/zt6mWySKARi7z7rgS5t496u1nkTYy3yY9vIZO7w9YWi9yk8Y72/49qnXof3Snss84Uxjf3ieLb9+frA5PP8lqAepNe5Ili+4O4Bq7hrnt/V3PE+cDbC9C2Ov3Y+8lDjE4PViEBQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIOgfLb1RU3zEbIYAAAAASUVORK5CYII=" /><!-- --></p>
<p>综合考虑两个维度的<span class="math inline">\(\hat R\)</span>统计量，大约在样本为4000时可以达到收敛。</p>
<div id="homework-2021-11-18" class="section level2">
<h2>homework 2021-11-18</h2>
<p>###11.3</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>cal1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a,d,k,n){</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  jc <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  asquare <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>), <span class="at">length=</span>n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> ((j <span class="sc">*</span> asquare<span class="sc">^</span>(i<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">/</span> ((<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">factorial</span>(i)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>i)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(i<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(i<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A[k<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>cal2 <span class="ot">&lt;-</span> <span class="cf">function</span>(a,d,k,n){</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  jc <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  asquare <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>), <span class="at">length=</span>n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> ((j <span class="sc">*</span> asquare<span class="sc">^</span>(i<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">/</span> ((<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">factorial</span>(i)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>i)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(i<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(i<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(A[k<span class="sc">+</span><span class="dv">1</span>],<span class="fu">sum</span>(A)))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>for <span class="math inline">\(a = (1,2)^T,d=1\)</span></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">cal2</span>(a,d,<span class="dv">10</span>,<span class="dv">10</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>## [1] 2.844232e-05 1.813549e+00</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">cal2</span>(a,d,<span class="dv">100</span>,<span class="dv">100</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>## [1] 8.211449e-123  1.813545e+00</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">cal2</span>(a,d,<span class="dv">200</span>,<span class="dv">200</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>res3</span></code></pre></div>
<pre><code>## [1] 0.000000 1.813545</code></pre>
<p>由结果知，第201项已经足够小，和为1.813545.</p>
<p>###11.5</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u,k0){</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>(u<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(k0<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k0<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  up <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  inte <span class="ot">&lt;-</span> <span class="fu">integrate</span>(integrand,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span>up,<span class="at">k0 =</span> k)<span class="sc">$</span>value</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">gamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)))<span class="sc">*</span>inte</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">g</span>(a,k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">g</span>(a,k)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(a))</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)){</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  C[i] <span class="ot">&lt;-</span> <span class="fu">f</span>(a[i],k)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(C)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">300</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>a0 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a0, <span class="fu">f1</span>(a0, k[<span class="dv">1</span>]), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>),<span class="at">xlab=</span><span class="st">&quot;a&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;f(a|k)&quot;</span>, <span class="at">main=</span><span class="st">&quot;f(a) with different k&quot;</span>)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a0, <span class="fu">f1</span>(a0, k[<span class="dv">7</span>]), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;k=16&quot;</span>, <span class="st">&quot;k=25&quot;</span>), <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可知，根在1，2之间。</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>sol <span class="ot">&lt;-</span> <span class="cf">function</span>(k1){</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span><span class="fu">uniroot</span>(f,<span class="at">k=</span>k1,<span class="at">lower =</span> <span class="dv">1</span>,<span class="at">upper =</span> <span class="dv">2</span>)<span class="sc">$</span>root</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a> m</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)){</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>B[i] <span class="ot">&lt;-</span> <span class="fu">sol</span>(k[i])</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 11.4</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="cf">function</span>(a,k){</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a> ck <span class="ot">=</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">pt</span>(ck,<span class="at">df=</span>k,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>solve <span class="ot">=</span> <span class="cf">function</span>(k){</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">=</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(a){<span class="fu">S</span>(a,k)<span class="sc">-</span><span class="fu">S</span>(a,k<span class="dv">-1</span>)},<span class="at">lower=</span><span class="dv">1</span>,<span class="at">upper=</span><span class="dv">2</span>)</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>root</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>root <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fu">length</span>(k))</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)){</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  root[<span class="dv">2</span>,i]<span class="ot">=</span><span class="fu">round</span>(<span class="fu">solve</span>(k[i]),<span class="dv">4</span>)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>root[<span class="dv">1</span>,] <span class="ot">=</span> k</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>root[<span class="dv">3</span>,] <span class="ot">=</span> B</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(root) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;A(k)&#39;</span>,<span class="st">&#39;B(k)&#39;</span>)</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>root</span></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]     [,4]      [,5]      [,6]      [,7]
## k    16.000000 17.000000 18.000000 19.00000 20.000000 21.000000 22.000000
## A(k)  1.663500  1.667300  1.670700  1.67380  1.676600  1.679200  1.681500
## B(k)  1.663452  1.667303  1.670745  1.67384  1.676637  1.679178  1.681496
##          [,8]      [,9]     [,10]     [,11]      [,12]      [,13]
## k    23.00000 24.000000 25.000000 50.000000 100.000000 300.000000
## A(k)  1.68360  1.685600  1.687400  1.709300   1.720600   1.728200
## B(k)  1.68362  1.685572  1.687373  1.709342   1.720608   1.728222</code></pre>
<p>相同的k，11.4中的<span class="math inline">\(A(k)\)</span>与本题中的<span class="math inline">\(B(k)\)</span>基本相同。</p>
<p>###附加题：</p>
<p>MLE:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>LL <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, y) {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(y))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y)){</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(y[i]<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    f[i] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pexp</span>(y[i],<span class="at">rate=</span>lambda)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    f[i] <span class="ot">&lt;-</span> <span class="fu">dexp</span>(y[i],<span class="at">rate=</span>lambda)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>( <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">log</span>(f)))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(y)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">optim</span>(lambda, LL, <span class="at">y=</span>y)</span></code></pre></div>
<pre><code>## Warning in optim(lambda, LL, y = y): one-dimensional optimization by Nelder-Mead is unreliable:
## use &quot;Brent&quot; or optimize() directly</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> opt<span class="sc">$</span>par</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>MLE</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<p>EM： 令缺失值为<span class="math inline">\(y=(y_1,y_2,y_3)\)</span> E step:</p>
<p><span class="math display">\[l_{o}(\lambda, y)=10 \log \lambda-\lambda \sum_{i=1}^{7} t_{i}-\lambda \sum_{j=1}^{3} y_{i}\]</span></p>
<p><span class="math inline">\(E l_{o}\left(\lambda_{0}, y\right)=10 \log \lambda-\lambda \sum_{i=1}^{7} t_{i}-3 \lambda E\left(y \mid \lambda_{0}\right)\)</span></p>
<p><span class="math inline">\(=10 \log \lambda-\lambda \sum_{i=1}^{7} t_{i}-3\lambda \frac{\lambda_{0}+1}{\lambda_{0}}\)</span></p>
<p>M step:</p>
<p><span class="math inline">\(\lambda_{1}=\arg \max _{\lambda} l(\lambda)=\frac{10}{\sum_{i=1}^{7} t_{i}+3 \frac{\lambda_{0}+1}{\lambda_{0}}}\)</span></p>
<p><span class="math inline">\(\hat{\lambda}=\frac{10}{\beta+3 \frac{\lambda_{0}+1}{\lambda_{0}}}\)</span></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#max. number of iterations</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(y) <span class="co">#initial est. for lambdas</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>L.old <span class="ot">&lt;-</span>L<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y)){</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(y[i]<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span>  l1<span class="sc">/</span> (beta0<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>(L<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>L)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(L <span class="sc">-</span> L.old)<span class="sc">/</span>L.old) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>L.old <span class="ot">&lt;-</span> L</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">lambda =</span> L, <span class="at">iter =</span> j, <span class="at">tol =</span> tol))</span></code></pre></div>
<pre><code>## $lambda
## [1] 1.037037
## 
## $iter
## [1] 15
## 
## $tol
## [1] 1.490116e-08</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>EM <span class="ot">&lt;-</span> L</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">MLE =</span> MLE , <span class="at">EM =</span> EM)</span></code></pre></div>
<pre><code>##      MLE       EM 
## 1.037037 1.037037</code></pre>
<p>两种方法得到的结果相似。</p>
</div>
<div id="homework-2021-11-25" class="section level2">
<h2>homework 2021-11-25</h2>
<ol style="list-style-type: decimal">
<li>Why are the following two invocations of lapply() equivalent? trims &lt;- c(0, 0.1, 0.2, 0.5) x &lt;- rcauchy(100) lapply(trims, function(trim) mean(x, trim = trim)) lapply(trims, mean, x = x)</li>
</ol>
<p>第一个语句中的每个元素trims都提供给mean()的第二个参数。 第二个语句中，是通过位置匹配发生的，因为mean()的第一个参数(x)是通过lapply()第三个参数中的名称(x)提供的。</p>
<ol start="5" style="list-style-type: decimal">
<li>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</li>
</ol>
<p>对第三题</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>ex3la <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data =</span> mtcars)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>ex3lf <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(formulas))</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)){</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  ex3lf[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(ex3la,rsq)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(ex3lf,rsq)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p>第四题</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>ex4la <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>ex4lf <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(bootstraps))</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)){</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  ex4lf[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(ex4la, rsq)</span></code></pre></div>
<pre><code>##  [1] 0.8510140 0.7080376 0.7178854 0.7356879 0.6397600 0.6657328 0.5693634
##  [8] 0.5631845 0.7318430 0.7512264</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(ex4lf, rsq)</span></code></pre></div>
<pre><code>##  [1] 0.8510140 0.7080376 0.7178854 0.7356879 0.6397600 0.6657328 0.5693634
##  [8] 0.5631845 0.7318430 0.7512264</code></pre>
</div>
<div id="homework-2021-12-02" class="section level2">
<h2>homework 2021-12-02</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12121</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;NumericMatrix gibbsC(int N, int a, int b, int n) {</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="st">  double x = 0, y = 0;</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="st">  mat(0,0) = 0;</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="st">  mat(0,1) = 0.5;</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i = 1; i &lt; N; i++) {</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="st">    x = rbinom(1, n, mat(i-1,1))[0];</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 0) = x;</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="st">    y = rbeta(1, x+a, n-x+b)[0];</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 1) = y;</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="st">  return(mat);</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, a, b, n){</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,X2)</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,n<span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(X)</span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(N,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">25</span>)</span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(N,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">25</span>)</span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>Cg <span class="ot">&lt;-</span> C[<span class="dv">1001</span><span class="sc">:</span>N,]</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>Rg <span class="ot">&lt;-</span> R[<span class="dv">1001</span><span class="sc">:</span>N,]</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>QC1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Cg[,<span class="dv">1</span>], a)</span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>QR1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Rg[,<span class="dv">1</span>], a)</span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>QC2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Cg[,<span class="dv">2</span>], a)</span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>QR2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Rg[,<span class="dv">2</span>], a)</span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(QC1, QR1,  <span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;C.gibbs1 Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R.gibbs1 Quantiles&quot;</span>)</span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(QC2, QR2,  <span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;C.gibbs2 Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R.gibbs2 Quantiles&quot;</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAclBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC2Zjq2tma225C2///bkDrbkJDbtmbb25Db/7bb////AAD/tmb/trb/25D//7b//9v////fqS3FAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALb0lEQVR4nO2diXLjuBGGMRvLSezN2omZZJnDZiTz/V8xxElCFvGjcRHy9F81U1QNDvIboNEAmqCYWUGJo2+gdzEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgoBXQ5flpHoV4eD/wbjrUCmh4eD8/nubhdNzN9CgH6PL8Mk9i+fPL70feT3fyAA0LnJEBedp0sdPl+eH98nw67mZ61NZIix9vn6+n4+6lS/EwD8SAgDaAlj728D48HXcvXWoFNP14G6WRZkKeHKDP18WRXtxoHuZ9eX6QBJTnKIp70QcZkG1BQ9ZkrH+bv8CZ54+P6Bu9tkHjMtvIqT4ncwMpPLL5JACSo5hYfMW8G8jKXV2Sj1DNJwVQXsVGRYqrJc1HzO0B1SquqGzzYUC3pQcv28yJgJT5Mcob5jPyVpXGI7uXNgPcgnwZ67NaSQbkSTacTfOZGZCv1fq4+yPboCdnhr6fDRLXzWfmFrSVw7O9OTqgy6/ah86crGbkrSM1Mb1qPnMOoLzlju4ACTOzuPbxqYCG1Q8KLZgtyU6fr0uivRltb4CMcZ6/zIHSW1BIajlEnPQ2dbi4PqRmFjfniFWMtFwykqsis0aVW1x1CWGM8405dAIg1XWCw7xcdDRGfM+UdwRI6OZzPXzZf40uxl0N0DrfVQtS1mfeXYJJsEER2xnOBilUWfXW1tJ85OD+dfiy/x5dkL1Q/QfpbkYx1Xz2208KoDK78n0AMq7zjvnRSaLLcldT3nI9sd6acr5PYAU4pYtRJqt7/nYHgNzMK7hA/tMu2gu7KA/u5SedzWvfZw6MXi5ldJHuyvaxO56s6pnXDMyPThpdprsaHt7H03x+DJlq6G0fCUgY3yeqq6c5ipOM7gjszY92qj/tzfmPA2TWfczojpNHl2svpKN4/tPv6s+ONv5zd1MNu+4T0bt0+uiC7YV8ernkEQC0cbY7m6zaZcNYPEk2SLo2w1Ooi/XagsS6bBjtZ6QM88NJjmShQczFxnRlg6i9S2cqnlDJugK7raw9IHrv0tmKJzykOFxfQu/SGckJ73LjUO2YUnuXzpmaMPNln6aA7I4pHU9OF8t7X6wlINt8kubI6YDuZWc1p/nMOYDuY2dViNCeTkwBqQkz3xdrBEg1n5hVjf0SyAmhi1O23izZWNWMFbpv7QeZ5pO1gPmdAQlhe1dGbSmzeVmjfCkz532o+oDMsli69THFUBOatbAxzZNut2hvV1Vza6ICmuw7GqPcWW5Qb2Lxm1XVzJJoCd22qnots0W9aaVvVlVzi6IldGuF48O/u3UUhX3RokRXTgXU71RDuGDMIpYutYt1O1ndLhsWKY+Y0Bnp8x+z3qirBSht2TBUIDWhG+bzQjwqATLWp6Afkeoo5h6vVAXQZuJerPxvNNUIB2Mml1o84UaB/fvygMr3Ll1s8YRz1HuJpQGZcJ9ig9dacPGEUma/sF0LWiempWd51TYOpRVvBYgQ7kMvu3hCo2FxmNoAIoX70EunJhyFCX5Gi/aLw9QEkBCRwXSJxRMTjkvD0Ov1cFfj/PiH+oDEJlK+jm9FS6iXET9fo84PWlzK2oDcuka1JbjE2byMUzx+Nl90XWOvDlpCtxA9nOIA1QwkL7uusVcJMaF9YBBBtVtKuTXpbfPJLixQDTWhncZ/vh7axQoviwUqKp6wSXGll8UCNRVPqFQ3kFwUXxYL1EVPGHHgdtVAcpEaTZdWGz0hPnC7ZhiwhJIYTZdWHzlhxIHbFQPJM8OhEiokJ4w4cLteCzLxLG16l6mRnDDiwO1ageQ2nqX+4LVWSU8Yc+B2nUDyIvEs1DqLJ6xWXKF4FmqtxRPWKq5UPAu12oSEqv9kboxRn7JcPAu1YnpC/d78mHeYK+0p196VH89CVMrOqh6YGh6XvF1Vbcwn0Q+Sahb+Un1VNVw7OaEd4EMv9Zast/6qarh+ekLt/E1tbFDSW4IlRV6ThpvKRetdJqbH9S5zB6UTliyu5brG3i0UT1iuOBPuc2DzmZs7ipRF+yrhPmR16yhmvuZVTJ06ipuJ6bF8unQUJZWqAQkUdegoihY7ytHqzVFURudjjjfltdWZoyjWPZ0OupdUX36Q3tPppXcp9QRI4fk43DX01Q8gbX268H22ItugSl9FUD6zOfW69H9GljoJXrCD17ET01uqA4gYvCC09emsc2mleNJuoN8L0SRuPXvGOfZ+WindURQvu0dvk4IXvN4VezftlDXV2GselBbUce9Sypqs7s5Xo4MXts0n9k7aKn25YwyFSscFL/RsnK1ybFDO4e2yOGWVu24+c8aSqzyOM8NV1Ks9843PMXWm2lONQKS9dJ37cwyv1Xgutl203/kcU2dKB5T9Mss94DlwNm8OzypbagUdNVmN/kr50coA9K/9LhYxWb0bUQHZs7lCb/tETDW8Miv9e+Xib6eWmxlyy3AKfcIv9pShbwhIOc/L84/B783/xC1IrXB8vv4ZnPCGJ6tRd3CXgOSTD8HH1um0hQvvvn5fQLmnB0Xewf0COpGyJt8BA6r77wyoS0Cri5l36v+3U//TyoPFgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAioIaBKbFW3vR0L+mbx+52V3B4tmqxwguTHi3vTwfiTkl79pL/d52eVbb1MZQsUA6S0Ps6Tk/UjIP5M/gXJV/Yla/a6KAdIn4JrQB+9HQn559fBXCiAve5+A1PcmzIai9yMhv/pJskF+9h67mO7/xgp4PxLyqx5DAnRVY8IYsaNOAcmd2wxAMorw/JjzoTSnPruY+pHexRJM4K76NNKj2UCItyJe9oQGvKtuh3liC/Kya1qZX2U26tdRJHrSXvYebZDqF/IGtRMy0ocRL/9Mnmp42QcRCnSiiCerQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBtQCkDtX5stEuXyQ+2y/Xn798wl5lWrfXJwE3+6cXVebmhJESagBIn2Mx3Hq8fUCfr0v60R6Voc+kCcdrWDB3B8g8++frjWCNfUB+CJYXl7WjuwVkD4r5nw1nGpbO8rcfb7qL/eVRdSR3sVxtIstMwI87XXY46edXfw064eX5t+flQuZ7+K/tYqO4UVqSqgP6cmylDG6ahAW0EJA9Z3PxMq8RvMM25HFWQWMOkIwmk+G+l2fZGXV59s94s7QkVQd0fbaw7iaDBST/celA7sKLm7On8GwD1yygy69vujBVwXKxAaTrDJ1KG6/mgPQ9TxbQi/7hLi7P6zNN1kbfAqQTiBfX5zaAdHoFLZtQ8y42eoBU31n+dhd6eDePb9He7GLy1LV/Pt4G5IJk19JS1c5IG1MAWpBKqlyCcfWCViMtP0ateagc5x1A/mtVWeHAzYd5M357Nkh+6d5cqCy6gWz+42WzWwr4z5LKmhwFerrdxfyRPm/cb+UoKsdP6csoJp/SXaj/fNWkPNM1KELSHZegl6sX3XjE0wbQkzeKyZZjS8u4+xZTDffpOxei+8s/tDHR7s/LvF7YOYWJtXfPNrmze2Rpv2kb9ONt2Fjt4coP0k0s962WgyarqePv38u8wkNQc0DKBu1+eKE/tW9BE+0tlaPF60FADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBPR/v8wrTQKc3SAAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="fu">gibbsC</span>(N,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">25</span>),<span class="fu">gibbsR</span>(N,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">25</span>))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(time)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##                  expr       lq   median       uq
## 1 gibbsC(N, 1, 1, 25)  1.64630  1.65565  1.66170
## 2 gibbsR(N, 1, 1, 25) 15.76625 20.86540 21.00505</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
